<!DOCTYPE html><html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /><title>Network I/O åˆæ¢ &mdash; dolphin</title><link rel="stylesheet" href="http://localhost:4000/assets/vendor/primer-css/css/primer.css"><link rel="stylesheet" href="http://localhost:4000/assets/css/components/collection.css"><link rel="stylesheet" href="http://localhost:4000/assets/css/components/repo-card.css"><link rel="stylesheet" href="http://localhost:4000/assets/css/sections/repo-list.css"><link rel="stylesheet" href="http://localhost:4000/assets/css/components/boxed-group.css"><link rel="stylesheet" href="http://localhost:4000/assets/css/globals/common.css"><link rel="stylesheet" href="http://localhost:4000/assets/css/globals/responsive.css"><link rel="stylesheet" href="http://localhost:4000/assets/css/posts/index.css"><link rel="stylesheet" href="http://localhost:4000/assets/vendor/octicons/octicons/octicons.css"><link rel="stylesheet" href="https://mazhuang.org/rouge-themes/dist/github.css"><link rel="stylesheet" href="http://localhost:4000/assets/vendor/share.js/dist/css/share.min.css"><link rel="canonical" href="http://localhost:4000/2022/02/05/Network-subSystem/"><link rel="alternate" type="application/atom+xml" title="dolphin" href="http://localhost:4000/feed.xml"><link rel="shortcut icon" href="http://localhost:4000/favicon.png"><meta property="og:title" content="Network I/O åˆæ¢"><meta name="keywords" content="IO, Java, ç£ç›˜, æ–‡ä»¶ç³»ç»Ÿ"><meta name="og:keywords" content="IO, Java, ç£ç›˜, æ–‡ä»¶ç³»ç»Ÿ"><meta name="description" content="ä¸€ã€æ¦‚è§ˆ"><meta name="og:description" content="ä¸€ã€æ¦‚è§ˆ"><meta property="og:url" content="http://localhost:4000/2022/02/05/Network-subSystem/"><meta property="og:site_name" content="dolphin"><meta property="og:type" content="article"><meta property="og:locale" content="zh_CN" /><meta property="article:published_time" content="2022-02-05"><title>Network I/O åˆæ¢ | dolphin</title><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Network I/O åˆæ¢" /><meta name="author" content="DempeZheng" /><meta property="og:locale" content="en_US" /><meta name="description" content="some word here" /><meta property="og:description" content="some word here" /><link rel="canonical" href="http://localhost:4000/2022/02/05/Network-subSystem/" /><meta property="og:url" content="http://localhost:4000/2022/02/05/Network-subSystem/" /><meta property="og:site_name" content="dolphin" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-05T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Network I/O åˆæ¢" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"DempeZheng"},"dateModified":"2022-02-05T00:00:00+08:00","datePublished":"2022-02-05T00:00:00+08:00","description":"some word here","headline":"Network I/O åˆæ¢","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2022/02/05/Network-subSystem/"},"url":"http://localhost:4000/2022/02/05/Network-subSystem/"}</script> <script src="http://localhost:4000/assets/vendor/jquery/dist/jquery.min.js"></script> <script src="http://localhost:4000/assets/js/jquery-ui.js"></script> <script src="http://localhost:4000/assets/js/main.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-RWCQYNELFN"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-RWCQYNELFN'); </script></head><body class="" data-mz=""><header class="site-header"><div class="container"><h1> <a href="http://localhost:4000/" title="dolphin"> <span class="octicon octicon-mark-github"></span> dolphin </a></h1><button class="collapsed mobile-visible" type="button" onclick="toggleMenu();"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button><nav class="site-header-nav" role="navigation"> <a href="http://localhost:4000/" class="site-header-nav-item" target="_self" title="ğŸ“°é¦–é¡µ"> <i class="octicon octicon-home"></i> ğŸ“°é¦–é¡µ </a> <a href="http://localhost:4000/categories/" class="site-header-nav-item" target="_self" title="åˆ†ç±»"> <i class="octicon octicon-book"></i> åˆ†ç±» </a> <a href="http://localhost:4000/wiki/" class="site-header-nav-item" target="_self" title="ç»´åŸº"> <i class=""></i> ç»´åŸº </a> <a href="http://localhost:4000/links/" class="site-header-nav-item" target="_self" title="é“¾æ¥"> <i class="octicon octicon-mail"></i> é“¾æ¥ </a> <a href="http://localhost:4000/about/" class="site-header-nav-item" target="_self" title="å…³äº"> <i class="octicon octicon-person"></i> å…³äº </a> <a class="mobile-hidden" href="http://localhost:4000/feed.xml" title="è®¢é˜… RSS"> <i class="octicon octicon-rss" style="color:orange;"></i> </a></nav></div></header><section class="collection-head small " data-pattern-id="55"><div class="container"><div class="columns"><div class="column three-fourths"><div class="collection-title"><h1 class="collection-header">Network I/O åˆæ¢</h1><div class="collection-info"> <span class="meta-info"> <span class="octicon octicon-calendar"></span> 2022/02/05 </span> <span class="meta-info"> <span class="octicon octicon-file-directory"></span> <a href="http://localhost:4000/categories/#æŠ€æœ¯" title="æŠ€æœ¯">æŠ€æœ¯</a> </span> <span class="meta-info"> <span class="octicon octicon-clock"></span> å…± 6754 å­—ï¼Œçº¦ 20 åˆ†é’Ÿ </span></div></div></div><div class="column one-fourth mobile-hidden"><div class="collection-title"></div></div></div></div></section><section class="container content"><div class="columns"><div class="column three-fourths" ><article class="article-content markdown-body"><h2 id="ä¸€æ¦‚è§ˆ">ä¸€ã€æ¦‚è§ˆ</h2><p><img src="https://i.stack.imgur.com/kiP8n.png" alt="" /></p><h2 id="äºŒlinux-network-subsystempacket-receiving-process">äºŒã€Linux Network subsystemï¼šPacket Receiving Process</h2><p><img src="https://myaut.github.io/dtrace-stap-book/images/net.png" alt="image:net" /></p><p><img src="https://www.researchgate.net/profile/Victor-Moreno-15/publication/279541668/figure/fig7/AS:669497044246544@1536631942904/Linux-NAPI-RX-scheme.png" alt="4: Linux NAPI RX scheme" /></p><h3 id="ring-buffer">Ring buffer</h3><p><strong>Ring Buffer</strong> ä½äº NIC å’Œ IP å±‚ä¹‹é—´ï¼ˆå‡†ç¡®çš„è¯´ä½äº NIC driver ä¸­ï¼‰ï¼Œæ˜¯ä¸€ä¸ªå…¸å‹çš„ FIFO ç¯å½¢é˜Ÿåˆ—ã€‚Ring Buffer æ²¡æœ‰åŒ…å«æ•°æ®æœ¬èº«ï¼Œè€Œæ˜¯åŒ…å«äº†æŒ‡å‘ <code class="language-plaintext highlighter-rouge">sk_buff</code>ï¼ˆsocket kernel buffersï¼‰çš„æè¿°ç¬¦</p><blockquote><p>Network input-output can require transferring huge amounts of data, so it may be ineffective to explicitly send write commands for each packet. Instead of handling each packet individually, NIC and its driver maintain shared <em>ring buffer</em> where driver puts data while card uses <em>DMA</em> (direct memory access) mechanisms to read data and send it over network. Ring buffers are defined by two pointers: <em>head</em> and <em>tail</em>:</p></blockquote><p><img src="https://myaut.github.io/dtrace-stap-book/images/ringbuf.png" alt="image:ringbuf" /></p><h3 id="ring-buffer--sk_buffer">Ring Buffer &amp; sk_buffer</h3><p><img src="https://myaut.github.io/dtrace-stap-book/images/linux/net.png" alt="image:linux/net" /></p><div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>net.ipv4.tcp_rmem = 4096    87380   16777216
</code></pre></div></div><h2 id="ä¸‰nic--device-driver-processing">ä¸‰ã€NIC &amp; Device Driver Processing</h2><p><img src="https://i.stack.imgur.com/ptPxv.png" alt="enter image description here" /></p><p><img src="https://ylgrgyq.github.io/2017/07/23/linux-receive-packet-1/ring-buffer.png" alt="å›¾ç‰‡æ¥è‡ªå‚è€ƒ1ï¼Œå¯¹ raise softirq çš„å‡½æ•°ååšäº†ä¿®æ”¹ï¼Œæ”¹ä¸ºäº† napi_schedule" /></p><h2 id="å››æ•°æ®åŒ…æ¥æ”¶è¿‡ç¨‹">å››ã€æ•°æ®åŒ…æ¥æ”¶è¿‡ç¨‹</h2><h3 id="ç½‘å¡å†…å­˜">ç½‘å¡â†’å†…å­˜</h3><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                    <span class="o">+-----+</span>
                   <span class="o">|</span>     <span class="o">|</span>                            <span class="no">Memroy</span>
<span class="o">+--------+</span>   <span class="mi">1</span>     <span class="o">|</span>     <span class="o">|</span>  <span class="mi">2</span>  <span class="no">DMA</span>     <span class="o">+--------+--------+--------+--------+</span>
<span class="o">|</span> <span class="no">Packet</span> <span class="o">|--------&gt;|</span> <span class="no">NIC</span> <span class="o">|------------&gt;|</span> <span class="no">Packet</span> <span class="o">|</span> <span class="no">Packet</span> <span class="o">|</span> <span class="no">Packet</span> <span class="o">|</span> <span class="o">......</span> <span class="o">|</span>
<span class="o">+--------+</span>         <span class="o">|</span>     <span class="o">|</span>             <span class="o">+--------+--------+--------+--------+</span>
                   <span class="o">|</span>     <span class="o">|&lt;--------+</span>
                   <span class="o">+-----+</span>         <span class="o">|</span>
                      <span class="o">|</span>            <span class="o">+---------------+</span>
                      <span class="o">|</span>                            <span class="o">|</span>
                    <span class="mi">3</span> <span class="o">|</span> <span class="no">Raise</span> <span class="no">IRQ</span>                  <span class="o">|</span> <span class="no">Disable</span> <span class="no">IRQ</span>
                      <span class="o">|</span>                          <span class="mi">5</span> <span class="o">|</span>
                      <span class="o">|</span>                            <span class="o">|</span>
                      <span class="err">â†“</span>                            <span class="o">|</span>
                   <span class="o">+-----+</span>                   <span class="o">+------------+</span>
                   <span class="o">|</span>     <span class="o">|</span>  <span class="no">Run</span> <span class="no">IRQ</span> <span class="n">handler</span>  <span class="o">|</span>            <span class="o">|</span>
                   <span class="o">|</span> <span class="no">CPU</span> <span class="o">|------------------&gt;|</span> <span class="no">NIC</span> <span class="no">Driver</span> <span class="o">|</span>
                   <span class="o">|</span>     <span class="o">|</span>       <span class="mi">4</span>           <span class="o">|</span>            <span class="o">|</span>
                   <span class="o">+-----+</span>                   <span class="o">+------------+</span>
                                                   <span class="o">|</span>
                                                <span class="mi">6</span>  <span class="o">|</span> <span class="no">Raise</span> <span class="n">soft</span> <span class="no">IRQ</span>
                                                   <span class="o">|</span>
                                                   <span class="err">â†“</span>
</code></pre></div></div><blockquote><p><strong>1ï¼š</strong>Â æ•°æ®åŒ…ä»å¤–é¢çš„ç½‘ç»œè¿›å…¥ç‰©ç†ç½‘å¡ã€‚å¦‚æœç›®çš„åœ°å€ä¸æ˜¯è¯¥ç½‘å¡ï¼Œä¸”è¯¥ç½‘å¡æ²¡æœ‰å¼€å¯æ··æ‚æ¨¡å¼ï¼Œè¯¥åŒ…ä¼šè¢«ç½‘å¡ä¸¢å¼ƒã€‚</p><p><strong>2ï¼š</strong>Â ç½‘å¡å°†æ•°æ®åŒ…é€šè¿‡<a href="https://link.segmentfault.com/?enc=QhyI%2FtG8dGg1LbmLlnpzuA%3D%3D.wXRjOjd3thJLeWC9gzDoXmVQhVSxEWMsWdzKuL74IzFGzsVHsQ2zKFbyecJ25C3iOkOam2GPPavLVor48Q%2FYnw%3D%3D">DMA</a>çš„æ–¹å¼å†™å…¥åˆ°æŒ‡å®šçš„å†…å­˜åœ°å€ï¼Œè¯¥åœ°å€ç”±ç½‘å¡é©±åŠ¨åˆ†é…å¹¶åˆå§‹åŒ–ã€‚æ³¨ï¼š è€çš„ç½‘å¡å¯èƒ½ä¸æ”¯æŒDMAï¼Œä¸è¿‡æ–°çš„ç½‘å¡ä¸€èˆ¬éƒ½æ”¯æŒã€‚</p><p><strong>3ï¼š</strong>Â ç½‘å¡é€šè¿‡ç¡¬ä»¶ä¸­æ–­ï¼ˆIRQï¼‰é€šçŸ¥CPUï¼Œå‘Šè¯‰å®ƒæœ‰æ•°æ®æ¥äº†</p><p><strong>4ï¼š</strong>Â CPUæ ¹æ®ä¸­æ–­è¡¨ï¼Œè°ƒç”¨å·²ç»æ³¨å†Œçš„ä¸­æ–­å‡½æ•°ï¼Œè¿™ä¸ªä¸­æ–­å‡½æ•°ä¼šè°ƒåˆ°é©±åŠ¨ç¨‹åºï¼ˆNIC Driverï¼‰ä¸­ç›¸åº”çš„å‡½æ•°</p><p><strong>5ï¼š</strong>Â é©±åŠ¨å…ˆç¦ç”¨ç½‘å¡çš„ä¸­æ–­ï¼Œè¡¨ç¤ºé©±åŠ¨ç¨‹åºå·²ç»çŸ¥é“å†…å­˜ä¸­æœ‰æ•°æ®äº†ï¼Œå‘Šè¯‰ç½‘å¡ä¸‹æ¬¡å†æ”¶åˆ°æ•°æ®åŒ…ç›´æ¥å†™å†…å­˜å°±å¯ä»¥äº†ï¼Œä¸è¦å†é€šçŸ¥CPUäº†ï¼Œè¿™æ ·å¯ä»¥æé«˜æ•ˆç‡ï¼Œé¿å…CPUä¸åœçš„è¢«ä¸­æ–­ã€‚</p><p><strong>6ï¼š</strong>Â å¯åŠ¨è½¯ä¸­æ–­ã€‚è¿™æ­¥ç»“æŸåï¼Œç¡¬ä»¶ä¸­æ–­å¤„ç†å‡½æ•°å°±ç»“æŸè¿”å›äº†ã€‚ç”±äºç¡¬ä¸­æ–­å¤„ç†ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¸èƒ½è¢«ä¸­æ–­ï¼Œæ‰€ä»¥å¦‚æœå®ƒæ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œä¼šå¯¼è‡´CPUæ²¡æ³•å“åº”å…¶å®ƒç¡¬ä»¶çš„ä¸­æ–­ï¼Œäºæ˜¯å†…æ ¸å¼•å…¥è½¯ä¸­æ–­ï¼Œè¿™æ ·å¯ä»¥å°†ç¡¬ä¸­æ–­å¤„ç†å‡½æ•°ä¸­è€—æ—¶çš„éƒ¨åˆ†ç§»åˆ°è½¯ä¸­æ–­å¤„ç†å‡½æ•°é‡Œé¢æ¥æ…¢æ…¢å¤„ç†ã€‚</p></blockquote><h3 id="å†…æ ¸ä¸­çš„ç½‘ç»œæ¨¡å—">å†…æ ¸ä¸­çš„ç½‘ç»œæ¨¡å—</h3><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                                                     <span class="o">+-----+</span>
                                             <span class="mi">17</span>      <span class="o">|</span>     <span class="o">|</span>
                                        <span class="o">+-----------&gt;|</span> <span class="no">NIC</span> <span class="o">|</span>
                                        <span class="o">|</span>            <span class="o">|</span>     <span class="o">|</span>
                                        <span class="o">|</span><span class="no">Enable</span> <span class="no">IRQ</span>  <span class="o">+-----+</span>
                                        <span class="o">|</span>
                                        <span class="o">|</span>
                                  <span class="o">+------------+</span>                                      <span class="no">Memroy</span>
                                  <span class="o">|</span>            <span class="o">|</span>        <span class="no">Read</span>           <span class="o">+--------+--------+--------+--------+</span>
                 <span class="o">+---------------&gt;|</span> <span class="no">NIC</span> <span class="no">Driver</span> <span class="o">|&lt;---------------------</span> <span class="o">|</span> <span class="no">Packet</span> <span class="o">|</span> <span class="no">Packet</span> <span class="o">|</span> <span class="no">Packet</span> <span class="o">|</span> <span class="o">......</span> <span class="o">|</span>
                 <span class="o">|</span>                <span class="o">|</span>            <span class="o">|</span>          <span class="mi">9</span>            <span class="o">+--------+--------+--------+--------+</span>
                 <span class="o">|</span>                <span class="o">+------------+</span>
                 <span class="o">|</span>                      <span class="o">|</span>    <span class="o">|</span>        <span class="n">skb</span>
            <span class="no">Poll</span> <span class="o">|</span> <span class="mi">8</span>      <span class="no">Raise</span> <span class="n">softIRQ</span> <span class="o">|</span> <span class="mi">6</span>  <span class="o">+-----------------+</span>
                 <span class="o">|</span>                      <span class="o">|</span>             <span class="mi">10</span>       <span class="o">|</span>
                 <span class="o">|</span>                      <span class="err">â†“</span>                      <span class="err">â†“</span>
         <span class="o">+---------------+</span>  <span class="no">Call</span>  <span class="o">+-----------+</span>        <span class="o">+------------------+</span>        <span class="o">+--------------------+</span>  <span class="mi">12</span>  <span class="o">+---------------------+</span>
         <span class="o">|</span> <span class="n">net_rx_action</span> <span class="o">|&lt;-------|</span> <span class="n">ksoftirqd</span> <span class="o">|</span>        <span class="o">|</span> <span class="n">napi_gro_receive</span> <span class="o">|-------&gt;|</span> <span class="n">enqueue_to_backlog</span> <span class="o">|-----&gt;|</span> <span class="no">CPU</span> <span class="n">input_pkt_queue</span> <span class="o">|</span>
         <span class="o">+---------------+</span>   <span class="mi">7</span>    <span class="o">+-----------+</span>        <span class="o">+------------------+</span>   <span class="mi">11</span>   <span class="o">+--------------------+</span>      <span class="o">+---------------------+</span>
                                                               <span class="o">|</span>                                                      <span class="o">|</span> <span class="mi">13</span>
                                                            <span class="mi">14</span> <span class="o">|</span>        <span class="o">+</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">-</span> <span class="o">+</span>
                                                               <span class="err">â†“</span>        <span class="err">â†“</span>
                                                    <span class="o">+--------------------------+</span>    <span class="mi">15</span>      <span class="o">+------------------------+</span>
                                                    <span class="o">|</span> <span class="n">__netif_receive_skb_core</span> <span class="o">|-----------&gt;|</span> <span class="n">packet</span> <span class="n">taps</span><span class="p">(</span><span class="no">AF_PACKET</span><span class="p">)</span> <span class="o">|</span>
                                                    <span class="o">+--------------------------+</span>            <span class="o">+------------------------+</span>
                                                               <span class="o">|</span>
                                                               <span class="o">|</span> <span class="mi">16</span>
                                                               <span class="err">â†“</span>
                                                      <span class="o">+-----------------+</span>
                                                      <span class="o">|</span> <span class="n">protocol</span> <span class="n">layers</span> <span class="o">|</span>
                                                      <span class="o">+-----------------+</span>
</code></pre></div></div><ul><li><strong>1ï¼š</strong>Â æ•°æ®åŒ…ä»å¤–é¢çš„ç½‘ç»œè¿›å…¥ç‰©ç†ç½‘å¡ã€‚å¦‚æœç›®çš„åœ°å€ä¸æ˜¯è¯¥ç½‘å¡ï¼Œä¸”è¯¥ç½‘å¡æ²¡æœ‰å¼€å¯æ··æ‚æ¨¡å¼ï¼Œè¯¥åŒ…ä¼šè¢«ç½‘å¡ä¸¢å¼ƒã€‚</li><li><strong>2ï¼š</strong>Â ç½‘å¡å°†æ•°æ®åŒ…é€šè¿‡<a href="https://link.segmentfault.com/?enc=QhyI%2FtG8dGg1LbmLlnpzuA%3D%3D.wXRjOjd3thJLeWC9gzDoXmVQhVSxEWMsWdzKuL74IzFGzsVHsQ2zKFbyecJ25C3iOkOam2GPPavLVor48Q%2FYnw%3D%3D">DMA</a>çš„æ–¹å¼å†™å…¥åˆ°æŒ‡å®šçš„å†…å­˜åœ°å€ï¼Œè¯¥åœ°å€ç”±ç½‘å¡é©±åŠ¨åˆ†é…å¹¶åˆå§‹åŒ–ã€‚æ³¨ï¼š è€çš„ç½‘å¡å¯èƒ½ä¸æ”¯æŒDMAï¼Œä¸è¿‡æ–°çš„ç½‘å¡ä¸€èˆ¬éƒ½æ”¯æŒã€‚</li><li><strong>3ï¼š</strong>Â ç½‘å¡é€šè¿‡ç¡¬ä»¶ä¸­æ–­ï¼ˆIRQï¼‰é€šçŸ¥CPUï¼Œå‘Šè¯‰å®ƒæœ‰æ•°æ®æ¥äº†</li><li><strong>4ï¼š</strong>Â CPUæ ¹æ®ä¸­æ–­è¡¨ï¼Œè°ƒç”¨å·²ç»æ³¨å†Œçš„ä¸­æ–­å‡½æ•°ï¼Œè¿™ä¸ªä¸­æ–­å‡½æ•°ä¼šè°ƒåˆ°é©±åŠ¨ç¨‹åºï¼ˆNIC Driverï¼‰ä¸­ç›¸åº”çš„å‡½æ•°</li><li><strong>5ï¼š</strong>Â é©±åŠ¨å…ˆç¦ç”¨ç½‘å¡çš„ä¸­æ–­ï¼Œè¡¨ç¤ºé©±åŠ¨ç¨‹åºå·²ç»çŸ¥é“å†…å­˜ä¸­æœ‰æ•°æ®äº†ï¼Œå‘Šè¯‰ç½‘å¡ä¸‹æ¬¡å†æ”¶åˆ°æ•°æ®åŒ…ç›´æ¥å†™å†…å­˜å°±å¯ä»¥äº†ï¼Œä¸è¦å†é€šçŸ¥CPUäº†ï¼Œè¿™æ ·å¯ä»¥æé«˜æ•ˆç‡ï¼Œé¿å…CPUä¸åœçš„è¢«ä¸­æ–­ã€‚</li><li><strong>6ï¼š</strong>Â å¯åŠ¨è½¯ä¸­æ–­ã€‚è¿™æ­¥ç»“æŸåï¼Œç¡¬ä»¶ä¸­æ–­å¤„ç†å‡½æ•°å°±ç»“æŸè¿”å›äº†ã€‚ç”±äºç¡¬ä¸­æ–­å¤„ç†ç¨‹åºæ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¸èƒ½è¢«ä¸­æ–­ï¼Œæ‰€ä»¥å¦‚æœå®ƒæ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œä¼šå¯¼è‡´CPUæ²¡æ³•å“åº”å…¶å®ƒç¡¬ä»¶çš„ä¸­æ–­ï¼Œäºæ˜¯å†…æ ¸å¼•å…¥è½¯ä¸­æ–­ï¼Œè¿™æ ·å¯ä»¥å°†ç¡¬ä¸­æ–­å¤„ç†å‡½æ•°ä¸­è€—æ—¶çš„éƒ¨åˆ†ç§»åˆ°è½¯ä¸­æ–­å¤„ç†å‡½æ•°é‡Œé¢æ¥æ…¢æ…¢å¤„ç†ã€‚</li></ul><h3 id="å†…æ ¸çš„ç½‘ç»œæ¨¡å—">å†…æ ¸çš„ç½‘ç»œæ¨¡å—</h3><p>è½¯ä¸­æ–­ä¼šè§¦å‘å†…æ ¸ç½‘ç»œæ¨¡å—ä¸­çš„è½¯ä¸­æ–­å¤„ç†å‡½æ•°ï¼Œåç»­æµç¨‹å¦‚ä¸‹</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>                                                 +-----+
                                         17      | |
                                    +-----------&gt;| NIC |
                                    | | |
                                    |Enable IRQ  +-----+ |
                                    | +------------+                                      Memroy | | Read           +--------+--------+--------+--------+
             +---------------&gt;| NIC Driver |&lt;--------------------- | Packet | Packet | Packet | ...... |
             | | | 9            +--------+--------+--------+--------+ | +------------+ | | | skb
        Poll | 8      Raise softIRQ | 6  +-----------------+ | | 10 |
             | â†“                      â†“
     +---------------+  Call  +-----------+        +------------------+        +--------------------+  12  +---------------------+ | net_rx_action |&lt;-------| ksoftirqd | | napi_gro_receive |-------&gt;| enqueue_to_backlog |-----&gt;| CPU input_pkt_queue |
     +---------------+   7    +-----------+        +------------------+   11   +--------------------+      +---------------------+
                                                           | | 13
                                                        14 | + - - - - - - - - - - - - - - - - - - - - - - +
                                                           â†“        â†“
                                                +--------------------------+    15      +------------------------+ | __netif_receive_skb_core |-----------&gt;| packet taps(AF_PACKET) |
                                                +--------------------------+            +------------------------+
                                                           | | 16
                                                           â†“
                                                  +-----------------+ | protocol layers |
                                                  +-----------------+
</code></pre></div></div><blockquote><p><strong>7ï¼š</strong>Â å†…æ ¸ä¸­çš„ksoftirqdè¿›ç¨‹ä¸“é—¨è´Ÿè´£è½¯ä¸­æ–­çš„å¤„ç†ï¼Œå½“å®ƒæ”¶åˆ°è½¯ä¸­æ–­åï¼Œå°±ä¼šè°ƒç”¨ç›¸åº”è½¯ä¸­æ–­æ‰€å¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œå¯¹äºä¸Šé¢ç¬¬6æ­¥ä¸­æ˜¯ç½‘å¡é©±åŠ¨æ¨¡å—æŠ›å‡ºçš„è½¯ä¸­æ–­ï¼Œksoftirqdä¼šè°ƒç”¨ç½‘ç»œæ¨¡å—çš„net_rx_actionå‡½æ•°</p><p><strong>8ï¼š</strong>Â net_rx_actionè°ƒç”¨ç½‘å¡é©±åŠ¨é‡Œçš„pollå‡½æ•°æ¥ä¸€ä¸ªä¸€ä¸ªçš„å¤„ç†æ•°æ®åŒ…</p><p><strong>9ï¼š</strong>Â åœ¨poolå‡½æ•°ä¸­ï¼Œé©±åŠ¨ä¼šä¸€ä¸ªæ¥ä¸€ä¸ªçš„è¯»å–ç½‘å¡å†™åˆ°å†…å­˜ä¸­çš„æ•°æ®åŒ…ï¼Œå†…å­˜ä¸­æ•°æ®åŒ…çš„æ ¼å¼åªæœ‰é©±åŠ¨çŸ¥é“</p><p><strong>10ï¼š</strong>Â é©±åŠ¨ç¨‹åºå°†å†…å­˜ä¸­çš„æ•°æ®åŒ…è½¬æ¢æˆå†…æ ¸ç½‘ç»œæ¨¡å—èƒ½è¯†åˆ«çš„skbæ ¼å¼ï¼Œç„¶åè°ƒç”¨napi_gro_receiveå‡½æ•°</p><p><strong>11ï¼š</strong>Â napi_gro_receiveä¼šå¤„ç†<a href="https://link.segmentfault.com/?enc=0BMPTeLSJVSdUPDk0VKANA%3D%3D.GLWVgnwM7nhKk9YFzbgZg7%2F%2BZygW2T%2Br6Daj7Vdia9R5lEwnZDq4qRXyOykqeNFB">GRO</a>ç›¸å…³çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯å°†å¯ä»¥åˆå¹¶çš„æ•°æ®åŒ…è¿›è¡Œåˆå¹¶ï¼Œè¿™æ ·å°±åªéœ€è¦è°ƒç”¨ä¸€æ¬¡åè®®æ ˆã€‚ç„¶ååˆ¤æ–­æ˜¯å¦å¼€å¯äº†<a href="https://link.segmentfault.com/?enc=N2IQEEClP7fHPtytgJpUzg%3D%3D.yJ4gIOTr9qBLB97oyBbB7YDzDtq8Q4YoC73FJmzJjjuVDfObZQuOSQWxo3NtALukj8HugsGPCoMlcOxOB7IejOjNXJduLUYdZUNFK5FPIoQiV9y%2B0o9KZNut1eIoIFp3">RPS</a>ï¼Œå¦‚æœå¼€å¯äº†ï¼Œå°†ä¼šè°ƒç”¨enqueue_to_backlog</p><p><strong>12ï¼š</strong>Â åœ¨enqueue_to_backlogå‡½æ•°ä¸­ï¼Œä¼šå°†æ•°æ®åŒ…æ”¾å…¥CPUçš„softnet_dataç»“æ„ä½“çš„input_pkt_queueä¸­ï¼Œç„¶åè¿”å›ï¼Œå¦‚æœinput_pkt_queueæ»¡äº†çš„è¯ï¼Œè¯¥æ•°æ®åŒ…å°†ä¼šè¢«ä¸¢å¼ƒï¼Œqueueçš„å¤§å°å¯ä»¥é€šè¿‡net.core.netdev_max_backlogæ¥é…ç½®</p><p><strong>13ï¼š</strong>Â CPUä¼šæ¥ç€åœ¨è‡ªå·±çš„è½¯ä¸­æ–­ä¸Šä¸‹æ–‡ä¸­å¤„ç†è‡ªå·±input_pkt_queueé‡Œçš„ç½‘ç»œæ•°æ®ï¼ˆè°ƒç”¨__netif_receive_skb_coreï¼‰</p><p><strong>14ï¼š</strong>Â å¦‚æœæ²¡å¼€å¯<a href="https://link.segmentfault.com/?enc=wvJ4e3u9YoQSACxTL8WNOg%3D%3D.YQHL%2FcinyDaNPhsFkn03QpuEg5lslVGESjXvtGh0I31FghKKCKO3bGNWV%2FJ6nNjukom4YkGzzndpOJz3ywv4O%2FvTf0Sw8QYeqp0IKPeoZ3N4%2B7S%2FpdPCku3sLKVkZtba">RPS</a>ï¼Œnapi_gro_receiveä¼šç›´æ¥è°ƒç”¨__netif_receive_skb_core</p><p><strong>15ï¼š</strong>Â çœ‹æ˜¯ä¸æ˜¯æœ‰AF_PACKETç±»å‹çš„socketï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„åŸå§‹å¥—æ¥å­—ï¼‰ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œæ‹·è´ä¸€ä»½æ•°æ®ç»™å®ƒã€‚tcpdumpæŠ“åŒ…å°±æ˜¯æŠ“çš„è¿™é‡Œçš„åŒ…ã€‚</p><p><strong>16ï¼š</strong>Â è°ƒç”¨åè®®æ ˆç›¸åº”çš„å‡½æ•°ï¼Œå°†æ•°æ®åŒ…äº¤ç»™åè®®æ ˆå¤„ç†ã€‚</p><p><strong>17ï¼š</strong>Â å¾…å†…å­˜ä¸­çš„æ‰€æœ‰æ•°æ®åŒ…è¢«å¤„ç†å®Œæˆåï¼ˆå³pollå‡½æ•°æ‰§è¡Œå®Œæˆï¼‰ï¼Œå¯ç”¨ç½‘å¡çš„ç¡¬ä¸­æ–­ï¼Œè¿™æ ·ä¸‹æ¬¡ç½‘å¡å†æ”¶åˆ°æ•°æ®çš„æ—¶å€™å°±ä¼šé€šçŸ¥CPU</p></blockquote><h3 id="åè®®æ ˆ">åè®®æ ˆ</h3><div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code>          <span class="o">|</span>
          <span class="o">|</span>
          <span class="err">â†“</span>         <span class="n">promiscuous</span> <span class="n">mode</span> <span class="o">&amp;&amp;</span>
      <span class="o">+--------+</span>    <span class="no">PACKET_OTHERHOST</span> <span class="p">(</span><span class="n">set</span> <span class="n">by</span> <span class="n">driver</span><span class="p">)</span>   <span class="o">+-----------------+</span>
      <span class="o">|</span> <span class="n">ip_rcv</span> <span class="o">|--------------------------------------&gt;|</span> <span class="n">drop</span> <span class="n">this</span> <span class="n">packet</span><span class="o">|</span>
      <span class="o">+--------+</span>                                       <span class="o">+-----------------+</span>
          <span class="o">|</span>
          <span class="o">|</span>
          <span class="err">â†“</span>
<span class="o">+---------------------+</span>
<span class="o">|</span> <span class="no">NF_INET_PRE_ROUTING</span> <span class="o">|</span>
<span class="o">+---------------------+</span>
          <span class="o">|</span>
          <span class="o">|</span>
          <span class="err">â†“</span>
      <span class="o">+---------+</span>
      <span class="o">|</span>         <span class="o">|</span> <span class="n">enabled</span> <span class="n">ip</span> <span class="n">forword</span>  <span class="o">+------------+</span>        <span class="o">+----------------+</span>
      <span class="o">|</span> <span class="n">routing</span> <span class="o">|--------------------&gt;|</span> <span class="n">ip_forward</span> <span class="o">|-------&gt;|</span> <span class="no">NF_INET_FORWARD</span> <span class="o">|</span>
      <span class="o">|</span>         <span class="o">|</span>                     <span class="o">+------------+</span>        <span class="o">+----------------+</span>
      <span class="o">+---------+</span>                                                   <span class="o">|</span>
          <span class="o">|</span>                                                         <span class="o">|</span>
          <span class="o">|</span> <span class="n">destination</span> <span class="no">IP</span> <span class="n">is</span> <span class="n">local</span>                                 <span class="err">â†“</span>
          <span class="err">â†“</span>                                                 <span class="o">+---------------+</span>
 <span class="o">+------------------+</span>                                       <span class="o">|</span> <span class="n">dst_output_sk</span> <span class="o">|</span>
 <span class="o">|</span> <span class="n">ip_local_deliver</span> <span class="o">|</span>                                       <span class="o">+---------------+</span>
 <span class="o">+------------------+</span>
          <span class="o">|</span>
          <span class="o">|</span>
          <span class="err">â†“</span>
 <span class="o">+------------------+</span>
 <span class="o">|</span> <span class="no">NF_INET_LOCAL_IN</span> <span class="o">|</span>
 <span class="o">+------------------+</span>
          <span class="o">|</span>
          <span class="o">|</span>
          <span class="err">â†“</span>
    <span class="o">+-----------+</span>
    <span class="o">|</span> <span class="no">UDP</span> <span class="n">layer</span> <span class="o">|</span>
    <span class="o">+-----------+</span>
</code></pre></div></div><blockquote><ul><li><strong>ip_rcvï¼š</strong>Â ip_rcvå‡½æ•°æ˜¯IPæ¨¡å—çš„å…¥å£å‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°é‡Œé¢ï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯å°†åƒåœ¾æ•°æ®åŒ…ï¼ˆç›®çš„macåœ°å€ä¸æ˜¯å½“å‰ç½‘å¡ï¼Œä½†ç”±äºç½‘å¡è®¾ç½®äº†æ··æ‚æ¨¡å¼è€Œè¢«æ¥æ”¶è¿›æ¥ï¼‰ç›´æ¥ä¸¢æ‰ï¼Œç„¶åè°ƒç”¨æ³¨å†Œåœ¨NF_INET_PRE_ROUTINGä¸Šçš„å‡½æ•°</li><li><strong>NF_INET_PRE_ROUTINGï¼š</strong>Â netfilteræ”¾åœ¨åè®®æ ˆä¸­çš„é’©å­ï¼Œå¯ä»¥é€šè¿‡iptablesæ¥æ³¨å…¥ä¸€äº›æ•°æ®åŒ…å¤„ç†å‡½æ•°ï¼Œç”¨æ¥ä¿®æ”¹æˆ–è€…ä¸¢å¼ƒæ•°æ®åŒ…ï¼Œå¦‚æœæ•°æ®åŒ…æ²¡è¢«ä¸¢å¼ƒï¼Œå°†ç»§ç»­å¾€ä¸‹èµ°</li><li><strong>routingï¼š</strong>Â è¿›è¡Œè·¯ç”±ï¼Œå¦‚æœæ˜¯ç›®çš„IPä¸æ˜¯æœ¬åœ°IPï¼Œä¸”æ²¡æœ‰å¼€å¯ip forwardåŠŸèƒ½ï¼Œé‚£ä¹ˆæ•°æ®åŒ…å°†è¢«ä¸¢å¼ƒï¼Œå¦‚æœå¼€å¯äº†ip forwardåŠŸèƒ½ï¼Œé‚£å°†è¿›å…¥ip_forwardå‡½æ•°</li><li><strong>ip_forwardï¼š</strong>Â ip_forwardä¼šå…ˆè°ƒç”¨netfilteræ³¨å†Œçš„NF_INET_FORWARDç›¸å…³å‡½æ•°ï¼Œå¦‚æœæ•°æ®åŒ…æ²¡æœ‰è¢«ä¸¢å¼ƒï¼Œé‚£ä¹ˆå°†ç»§ç»­å¾€åè°ƒç”¨dst_output_skå‡½æ•°</li><li><strong>dst_output_skï¼š</strong>Â è¯¥å‡½æ•°ä¼šè°ƒç”¨IPå±‚çš„ç›¸åº”å‡½æ•°å°†è¯¥æ•°æ®åŒ…å‘é€å‡ºå»ï¼ŒåŒä¸‹ä¸€ç¯‡è¦ä»‹ç»çš„æ•°æ®åŒ…å‘é€æµç¨‹çš„ååŠéƒ¨åˆ†ä¸€æ ·ã€‚</li><li><strong>ip_local_deliver</strong>ï¼šå¦‚æœä¸Šé¢<strong>routing</strong>çš„æ—¶å€™å‘ç°ç›®çš„IPæ˜¯æœ¬åœ°IPï¼Œé‚£ä¹ˆå°†ä¼šè°ƒç”¨è¯¥å‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°ä¸­ï¼Œä¼šå…ˆè°ƒç”¨NF_INET_LOCAL_INç›¸å…³çš„é’©å­ç¨‹åºï¼Œå¦‚æœé€šè¿‡ï¼Œæ•°æ®åŒ…å°†ä¼šå‘ä¸‹å‘é€åˆ°UDPå±‚</li></ul></blockquote><h2 id="äº”ioæ¨¡å‹">äº”ã€I/Oæ¨¡å‹</h2><h3 id="é˜»å¡å¼io">é˜»å¡å¼I/O</h3><p><img src="https://pdai.tech/_images/pics/1492928416812_4.png" alt="" /></p><h3 id="éé˜»å¡å¼io">éé˜»å¡å¼I/O</h3><p><img src="https://pdai.tech/_images/pics/1492929000361_5.png" alt="" /></p><h3 id="ioå¤šè·¯å¤ç”¨">I/Oå¤šè·¯å¤ç”¨</h3><p><img src="https://pdai.tech/_images/pics/1492929444818_6.png" alt="" /></p><h4 id="å¤šè·¯å¤ç”¨ioå®ç°">å¤šè·¯å¤ç”¨I/Oå®ç°</h4><ul><li><p>select</p><ul><li><p>selectçš„timeoutæ˜¯1nsï¼Œpollå’Œepollçš„timeoutæ˜¯1msï¼Œselecté€‚ç”¨äºå®æ—¶æ€§æ›´é«˜çš„åœºæ™¯ï¼Œä¾‹å¦‚æ ¸ååº”å †</p></li><li><p>selectå¯ç§»æ¤æ€§å¥½</p></li></ul></li><li><p>poll</p></li><li><p>epoll</p></li><li><p>kqueue</p></li></ul><h3 id="ä¿¡å·é‡é©±åŠ¨">ä¿¡å·é‡é©±åŠ¨</h3><p><img src="https://pdai.tech/_images/pics/1492929553651_7.png" alt="" /></p><h3 id="å¼‚æ­¥io">å¼‚æ­¥I/O</h3><p><img src="https://pdai.tech/_images/pics/1492930243286_8.png" alt="" /></p><h3 id="äº”å¤§ioæ¨¡å‹æ¯”è¾ƒ">äº”å¤§I/Oæ¨¡å‹æ¯”è¾ƒ</h3><p><img src="https://pdai.tech/_images/pics/1492928105791_3.png" alt="" /></p><h2 id="å…­reactor-pattern">å…­ã€Reactor pattern</h2><blockquote><p><strong>Reactoræ¨¡å¼çš„åº•å±‚å¾€å¾€ä½¿ç”¨select/poll/epollç­‰I/Oå¤ç”¨æ–¹å¼æ¥å®ç°ï¼›Proactoræ¨¡å¼çš„åº•å±‚ä½¿ç”¨å¼‚æ­¥I/Oï¼ˆå¦‚Windowsä¸­çš„å®Œæˆç«¯å£æˆ–UNIXä¸­aio_*()ç³»åˆ—å‡½æ•°ï¼‰æ¥å®ç°ã€‚</strong></p></blockquote><h3 id="ä¼ ç»Ÿioæ¨¡å‹">ä¼ ç»ŸIOæ¨¡å‹</h3><p>per thead per connection</p><p><img src="https://pdai.tech/_images/io/java-io-reactor-1.png" alt="" /></p><h3 id="reactoräº‹ä»¶é©±åŠ¨æ¨¡å‹">Reactoräº‹ä»¶é©±åŠ¨æ¨¡å‹</h3><p><img src="https://pdai.tech/_images/io/java-io-reactor-2.png" alt="" /></p><h3 id="reactoræ¨¡å‹ä¸šåŠ¡ioåˆ†ç¦»">Reactoræ¨¡å‹ï¼šä¸šåŠ¡&amp;IOåˆ†ç¦»</h3><p><img src="https://pdai.tech/_images/io/java-io-reactor-3.png" alt="" /></p><h3 id="reactoræ¨¡å‹mainreactorsubreactor">Reactoræ¨¡å‹ï¼šmainReactor&amp;subReactor</h3><p><img src="https://pdai.tech/_images/io/java-io-reactor-4.png" alt="" /></p><h2 id="ä¸ƒç½‘ç»œé“¾è·¯è°ƒä¼˜">ä¸ƒã€ç½‘ç»œé“¾è·¯è°ƒä¼˜</h2><ol><li><p><strong>ç½‘å¡Ring Buffer</strong>ï¼šæ ¹æ®ä¸åŒçš„ç½‘å¡ç±»å‹ï¼ŒæŠŠRing Bufferè®¾ç½®æˆæœ€å¤§å€¼ï¼›</p></li><li><p><strong>ç½‘å¡è½¯ä¸­æ–­</strong>ï¼šæ‰‹å·¥ç»‘å®šä¸­æ–­åˆ°å¤šæ ¸CPUï¼Œé¿å…CPU0çš„æ€§èƒ½ç“¶é¢ˆï¼Œæå‡æ•´ä½“æ€§èƒ½ï¼›</p></li><li><p><strong>ç½‘å¡ç¼“å†²åŒºåˆ°TCP/IPæ ˆä¹‹é—´</strong>ï¼šé€‚å½“å¢åŠ net.core.netdev_max_backlogçš„å€¼ï¼Œæå‡Input Packet Queue;</p></li><li><p><strong>åŠè¿æ¥é˜Ÿåˆ—</strong>ï¼šå¼€å¯net.ipv4.tcp_syncookiesï¼Œé˜²èŒƒå°‘é‡çš„tcp synæ”»å‡»</p></li><li><p><strong>å®Œæ•´è¿æ¥é˜Ÿåˆ—</strong>ï¼šé€šè¿‡net.core.somaxconn,è°ƒå¤§ä¸€äº›é˜Ÿåˆ—é•¿åº¦,ç»™åº”ç”¨ç¨‹åºä»¥æ›´å¤šå¤„ç†æ—¶é—´</p></li><li><p><strong>Socket Recv Buffer</strong>ï¼šå¼€å¯net.ipv4.tcp_moderate_rcvbuf=1,è‡ªåŠ¨è°ƒèŠ‚æœºåˆ¶ç”Ÿæ•ˆï¼Œå¹¶ä¸”æŠŠnet.ipv4.tcp_rmem/net.core.rmem_maxä¸­é»˜è®¤å€¼å’Œæœ€å¤§å€¼è°ƒå¤§</p></li></ol><h2 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h2><p>https://i.stack.imgur.com/DN7Vg.png</p><p>https://pdai.tech/md/java/io/java-io-nio-select-epoll.html</p><p>https://indico.cern.ch/event/408139/contributions/979737/attachments/815628/1117588/CHEP06.pdf</p><p>https://myaut.github.io/dtrace-stap-book/kernel/net.html</p><p><a href="https://stackoverflow.com/questions/47450231/what-is-the-relationship-of-dma-ring-buffer-and-tx-rx-ring-for-a-network-card">linux - What is the relationship of DMA ring buffer and TX/RX ring for a network card? - Stack Overflow</a></p></article><div class="share"><div class="share-component" data-disabled='qq,douban,qzone,linkedin'></div></div><div class="comment"><div id="gitalk-container"></div><link rel="stylesheet" href="http://localhost:4000/assets/vendor/gitalk/gitalk.css"> <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script> <script> var gitalk = new Gitalk({ id: '/2022/02/05/Network-subSystem/', clientID: 'Ov23li6FmCJDmAIlZmNK', clientSecret: '81bd012195b582aa2cabb7d2d472dd173353beef', repo: 'blog-comments', owner: 'HeroesZheng', admin: ['HeroesZheng'], labels: ['gitment'], perPage: 50, }); gitalk.render('gitalk-container'); </script></div></div><div class="column one-fourth"><h3 class="post-directory-title mobile-hidden">Table of Contents</h3><div id="post-directory-module" class="mobile-hidden"><section class="post-directory"><dl></dl></section></div><script src="http://localhost:4000/assets/js/jquery.toc.js"></script></div></div></section><footer class="container"><div class="site-footer" role="contentinfo"><div class="copyright left mobile-block"> Â© 2015 <span title="DempeZheng">DempeZheng</span> <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a></div><ul class="site-footer-links right mobile-hidden"><li> <a href="javascript:window.scrollTo(0,0)" >TOP</a></li></ul><a href="" target="_blank" aria-label="view source code"> <span class="mega-octicon octicon-mark-github" title="GitHub"></span> </a><ul class="site-footer-links mobile-hidden"><li> <a href="http://localhost:4000/" title="ğŸ“°é¦–é¡µ" target="">ğŸ“°é¦–é¡µ</a></li><li> <a href="http://localhost:4000/categories/" title="åˆ†ç±»" target="">åˆ†ç±»</a></li><li> <a href="http://localhost:4000/wiki/" title="ç»´åŸº" target="">ç»´åŸº</a></li><li> <a href="http://localhost:4000/links/" title="é“¾æ¥" target="">é“¾æ¥</a></li><li> <a href="http://localhost:4000/about/" title="å…³äº" target="">å…³äº</a></li><li><a href="http://localhost:4000/feed.xml"><span class="octicon octicon-rss" style="color:orange;"></span></a></li></ul></div></footer><div class="tools-wrapper"> <a class="gotop" href="#" title="å›åˆ°é¡¶éƒ¨"><span class="octicon octicon-arrow-up"></span></a></div><script src="http://localhost:4000/assets/vendor/share.js/dist/js/share.min.js"></script> <script src="http://localhost:4000/assets/js/geopattern.js"></script> <script> jQuery(document).ready(function($) { $('.geopattern').each(function(){ $(this).geopattern($(this).data('pattern-id')); }); /* hljs.initHighlightingOnLoad(); */ }); </script></body></html>
